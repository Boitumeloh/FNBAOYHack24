<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Businesses - Township Micro-Investment Platform</title>
    <link rel="stylesheet" href="/styles.css" />
    <link rel="stylesheet"
        href="https://cdn-uicons.flaticon.com/2.6.0/uicons-bold-straight/css/uicons-bold-straight.css" />
</head>

<body>
    <!-- Navbar -->
    <header class="navbar">
        <a href="/home">
            <h1 class="logo"><i class="fi fi-bs-square-m"></i>Makhie</h1>
        </a>
        <nav>
            <ul>
                <li><a href="/home">Home</a></li>
                <li><a href="/businesses" class="active">Businesses</a></li>
                <li><a href="/dashboard">Dashboard</a></li>
                <li id="authLink"></li>
            </ul>
        </nav>
    </header>

    <!-- Businesses Section -->
    <section class="businesses-section">
        <h2>Explore Businesses & Investment Opportunities</h2>
        <div class="businesses-container">
            <% businesses.forEach(function(business) { %>
                <!-- Business Card -->
                <div class="business-card">
                    <!-- Displaying Image with Check for Image Data -->
                    <% if (business.image && business.image.data) { %>
                        <img src="data:<%= business.image.contentType %>;base64,<%= business.image.data.toString('base64') %>"
                            alt="<%= business.business_name %>" class="business-image" />
                        <% } else { %>
                            <!-- Placeholder Image if no image data exists -->
                            <img src="/path/to/placeholder-image.jpg"
                                alt="No image available for <%= business.business_name %>" class="business-image" />
                            <% } %>

                                <div class="business-info">
                                    <h3>
                                        <%= business.business_name %>
                                    </h3>
                                    <p>
                                        <%= business.description || "No description available." %>
                                    </p>
                                    <div class="progress-bar">
                                        <div class="progress" style="width: <%= business.fundedPercentage %>%"></div>
                                    </div>
                                    <p>
                                        <%= business.fundedPercentage %>% funded
                                    </p>
                                    <a href="/about/<%= business._id %>"><button class="invest-button">About Us</button></a>
                                    
                                    <!-- Contribute Button Section -->
                                    <form style="text-align: center;" action="/contribute" method="POST"
                                        class="contribute-form">
                                        <input type="hidden" name="businessId" value="<%= business._id %>">
                                        <button type="submit" class="cta-button">Contribute!</button>
                                    </form>
                                </div>
                </div>
                <% }); %>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <p>&copy; 2024 Township Micro-Investment Platform. All Rights Reserved.</p>
    </footer>

    <script src="/scripts/app.js"></script>
    <script src="/scripts/logout.js"></script>
    <script src="/scripts/linkDisplay.js"></script>
</body>

</html>